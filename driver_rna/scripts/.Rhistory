resSig_down <- subset(res, res$adj_pval < 0.05 & lfc >= -1)
deg <- rbind(resSig_down, resSig_up)
hs <- org.Hs.eg.db
my_symbols <- deg$name
gene_list <- select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- na.omit(gene_list)
# Preparing input #
gene_list <- gene_list[!duplicated(gene_list$SYMBOL),]
gene_list <- gene_list[gene_list$SYMBOL %in% deg$name,]
gene_list_rank <- as.vector(deg$lfc)
names(gene_list_rank) <- gene_list$ENTREZID
gene_list_rank <- sort(gene_list_rank, decreasing = TRUE)
# Running fgsea #
pathways <- reactomePathways(names(gene_list_rank))
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
View(res_gseGO)
res_gseGO@result
# Filter DEG #
resSig_up <- subset(res, res$adj_pval < 0.05 & lfc >= 1)
resSig_down <- subset(res, res$adj_pval < 0.05 & lfc >= -1)
resSig_down <- subset(res, res$adj_pval < 0.05 & lfc <= -1)
deg <- rbind(resSig_down, resSig_up)
hs <- org.Hs.eg.db
my_symbols <- deg$name
gene_list <- select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
my_symbols <- deg$name
gene_list <- select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
View(deg)
hs <- org.Hs.eg.db
my_symbols <- deg$name
gene_list <- select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
# Convert Gene symbols to EntrezID #
#BiocManager::install("org.Hs.eg.db")
library(org.Hs.eg.db)
gene_list <- select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- org.Hs.eg.db::select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- AnnotationDbi::select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- na.omit(gene_list)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
View(res_gseGO)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "ALL", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
View(res_gseGO)
# Filter DEG #
resSig_up <- subset(res, res$adj_pval < 0.05 & lfc > 0.5)
resSig_down <- subset(res, res$adj_pval < 0.05 & lfc < -0.5)
deg <- rbind(resSig_down, resSig_up)
hs <- org.Hs.eg.db
my_symbols <- deg$name
gene_list <- AnnotationDbi::select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- na.omit(gene_list)
# Preparing input #
gene_list <- gene_list[!duplicated(gene_list$SYMBOL),]
gene_list <- gene_list[gene_list$SYMBOL %in% deg$name,]
gene_list_rank <- as.vector(deg$lfc)
names(gene_list_rank) <- gene_list$ENTREZID
gene_list_rank <- sort(gene_list_rank, decreasing = TRUE)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
View(res_gseGO)
res_gseGO@result[["Description"]]
res_gseGO@result
res_gse <- res_gseGO@result
View(res_gse)
res_gse <- res_gse %>%
filter(Description %in% c("neurotrasmitter transport", "acetylcholine receptor signaling pathway", "photoreceptor cell development",
"synapse assembly", "regulation of protein secretion", "DNA metabolic process", "mitotic cell cycle",
"chromosome organization", "Wnt signaling pathway", "DNA replication" ))
View(res_gse)
4.668525e-02
4.551347e-02
3.598000e-07
6.441903e-04
#Select enriched pathways
res_gse <- res_gseGO@result
4.600463e-05
res_gse <- res_gse %>%
filter(Description %in% c("neurotransmitter transport", "acetylcholine receptor signaling pathway", "photoreceptor cell development",
"synapse assembly", "regulation of protein secretion", "DNA metabolic process", "mitotic cell cycle",
"chromosome organization", "Wnt signaling pathway", "DNA replication" ))
View(res_gse)
res_gse <- res_gse %>%
filter(Description %in% c("neurotransmitter transport", "acetylcholine receptor signaling pathway", "photoreceptor cell development",
"synapse assembly", "regulation of protein secretion", "DNA metabolic process", "mitotic cell cycle",
"chromosome organization", "Wnt signaling pathway", "DNA replication" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'dow-regulated'))
### GO Enrichment ###
library(tidyverse)
res_gse <- res_gse %>%
filter(Description %in% c("neurotransmitter transport", "acetylcholine receptor signaling pathway", "photoreceptor cell development",
"synapse assembly", "regulation of protein secretion", "DNA metabolic process", "mitotic cell cycle",
"chromosome organization", "Wnt signaling pathway", "DNA replication" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'dow-regulated'))
View(res_gse)
# making ggdotchart
library(ggpubr)
View(res_gse)
View(res_gse)
plot <- ggdotchart(res_gse, x = -log10(p.adjust), y = Description,
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
ggtheme = theme_pubr())
View(res_gse)
plot <- ggdotchart(res_gse, x = p.adjust, y = Description,
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
ggtheme = theme_pubr())
View(res_gse)
plot <- ggdotchart(res_gse, x = p.adjust, y = "Description",
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
ggtheme = theme_pubr())
plot <- ggdotchart(res_gse, x = -log10("p.adjust"), y = "Description",
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
ggtheme = theme_pubr()
)
plot <- ggdotchart(res_gse, x = "p.adjust", y = "Description",
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
ggtheme = theme_pubr()
)
plot
plot <- ggdotchart(res_gse, x = "Description", y = "p.adjust",
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments"
ggtheme = theme_pubr()
plot <- ggdotchart(res_gse, x = "Description", y = "p.adjust",
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
ggtheme = theme_pubr()
)
plot
plot
plot <- ggdotchart(res_gse, x = "Description", y = -log10("p.adjust")
color = "gene_clusters",
plot <- ggdotchart(res_gse, x = "Description", y = -log10("p.adjust"),
color = "gene_clusters",
palette = NULL,
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
ggtheme = theme_pubr()
)
res_gse <- res_gse %>%
filter(Description %in% c("neurotransmitter transport", "acetylcholine receptor signaling pathway", "photoreceptor cell development",
"synapse assembly", "regulation of protein secretion", "DNA metabolic process", "mitotic cell cycle",
"chromosome organization", "Wnt signaling pathway", "DNA replication" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
plot <- ggdotchart(res_gse, x = "Description", y = -log10("p.adjust"),
color = "gene_clusters",
palette = NULL,
sorting = "ascending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
ggtheme = theme_pubr()
)
plot <- ggdotchart(res_gse, x = "Description", y = "p.adjust",
color = "gene_clusters",
palette = NULL,
sorting = "ascending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
ggtheme = theme_pubr()
)
plot
)
plot <- ggdotchart(res_gse, x = "Description", y = "p.adjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
ggtheme = theme_pubr()
)
plot
View(res_gse)
res_gse <- -log10(res_gse$p.adjust)
#Select enriched pathways
res_gse <- res_gseGO@result
res_gse <- res_gse %>%
filter(Description %in% c("neurotransmitter transport", "acetylcholine receptor signaling pathway", "photoreceptor cell development",
"synapse assembly", "regulation of protein secretion", "DNA metabolic process", "mitotic cell cycle",
"chromosome organization", "Wnt signaling pathway", "DNA replication" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
res_gse$log_padjust <- -log10(res_gse$p.adjust)
View(res_gse)
plot <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
ggtheme = theme_pubr()
)
plot
plot1 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Enrichment RGCs vs RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot1
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_test_retina_cell_types1.Rdata")
plot1 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Enrichment Differentiated neurons vs RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot1
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_test_retina_cell_types2.Rdata")
View(stat_test_retina)
plot1
View(stat_test_retina)
res <- subset(stat_test_retina, lfc >= -5)
View(res)
# Filter DEG #
resSig_up <- subset(res, res$adj_pval < 0.05 & lfc > 0.5)
resSig_down <- subset(res, res$adj_pval < 0.05 & lfc < -0.5)
hs <- org.Hs.eg.db
my_symbols <- deg$name
gene_list <- AnnotationDbi::select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- na.omit(gene_list)
# Preparing input #
gene_list <- gene_list[!duplicated(gene_list$SYMBOL),]
gene_list <- gene_list[gene_list$SYMBOL %in% deg$name,]
gene_list_rank <- as.vector(deg$lfc)
names(gene_list_rank) <- gene_list$ENTREZID
gene_list_rank <- sort(gene_list_rank, decreasing = TRUE)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
#Select enriched pathways
res_gse <- res_gseGO@result
View(res_gse)
1.799000e-07
2.309184e-02
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "MF", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
#Select enriched pathways
res_gse <- res_gseGO@result
View(res_gse)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
#Select enriched pathways
res_gse <- res_gseGO@result
res_gse <- res_gse %>%
filter(Description %in% c("DNA metabolic process", "mitotic cell cycle", "DNA replication",
"canonical WNT signaling pathway", "chromosome organization",
"neurotrasmitter secretion", "dopamine receptor signaling pathway",
"synapse organization", "eye photoreceptor cell development","myotube cell development" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
res_gse$log_padjust <- -log10(res_gse$p.adjust)
plot2 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Enrichment RGCs vs RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot2
res_gse <- res_gse %>%
filter(Description %in% c("DNA metabolic process", "mitotic cell cycle", "DNA replication",
"canonical Wnt signaling pathway", "chromosome organization",
"neurotransmitter secretion", "dopamine receptor signaling pathway",
"synapse organization", "eye photoreceptor cell development","myotube cell development" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
res_gse$log_padjust <- -log10(res_gse$p.adjust)
plot2 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Enrichment RGCs vs RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot2
View(res_gseGO)
#Select enriched pathways
res_gse <- res_gseGO@result
res_gse <- res_gse %>%
filter(Description %in% c("DNA metabolic process", "mitotic cell cycle", "DNA replication",
"canonical Wnt signaling pathway", "chromosome organization",
"neurotransmitter secretion", "dopamine receptor signaling pathway",
"synapse organization", "eye photoreceptor cell development","myotube cell development" )) %>%
mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
res_gse$log_padjust <- -log10(res_gse$p.adjust)
plot2 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Enrichment RGCs vs RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot2
plot1 + plot2
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_test_retina_tissue3.Rdata")
View(stat_test_retina)
res <- subset(stat_test_retina, lfc >= -5)
# Filter DEG #
resSig_up <- subset(res, res$adj_pval < 0.05 & lfc > 0.5)
resSig_down <- subset(res, res$adj_pval < 0.05 & lfc < -0.5)
hs <- org.Hs.eg.db
deg <- rbind(resSig_down, resSig_up)
my_symbols <- deg$name
gene_list <- AnnotationDbi::select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- na.omit(gene_list)
# Preparing input #
gene_list <- gene_list[!duplicated(gene_list$SYMBOL),]
gene_list <- gene_list[gene_list$SYMBOL %in% deg$name,]
gene_list_rank <- as.vector(deg$lfc)
names(gene_list_rank) <- gene_list$ENTREZID
gene_list_rank <- sort(gene_list_rank, decreasing = TRUE)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
#Select enriched pathways
res_gse <- res_gseGO@result
View(res_gse)
#Select enriched pathways
res_gse <- res_gseGO@result
View(res_gse)
res_gse <- res_gse %>% mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
res_gse$log_padjust <- -log10(res_gse$p.adjust)
plot3 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Macula vs Peripheral retina, RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot3
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_dev_stage_rpc.Rdata")
View(stat_test_retina)
res <- subset(stat_test_retina, lfc >= -5)
# Filter DEG #
resSig_up <- subset(res, res$adj_pval < 0.05 & lfc > 0.5)
resSig_down <- subset(res, res$adj_pval < 0.05 & lfc < -0.5)
deg <- rbind(resSig_down, resSig_up)
hs <- org.Hs.eg.db
my_symbols <- deg$name
gene_list <- AnnotationDbi::select(hs,
keys = my_symbols,
columns = c("ENTREZID", "SYMBOL"),
keytype = "SYMBOL")
gene_list <- na.omit(gene_list)
# Preparing input #
gene_list <- gene_list[!duplicated(gene_list$SYMBOL),]
gene_list <- gene_list[gene_list$SYMBOL %in% deg$name,]
gene_list_rank <- as.vector(deg$lfc)
names(gene_list_rank) <- gene_list$ENTREZID
gene_list_rank <- sort(gene_list_rank, decreasing = TRUE)
res_gseGO <- gseGO(geneList = gene_list_rank, ont = "BP", OrgDb = org.Hs.eg.db,
keyType = "ENTREZID", minGSSize = 10, maxGSSize = 350)
#Select enriched pathways
res_gse <- res_gseGO@result
View(res_gse)
res_gse <- res_gse %>% mutate(gene_clusters = case_when(
NES > 0  ~ 'up-regulated',
NES < 0  ~ 'down-regulated'))
res_gse$log_padjust <- -log10(res_gse$p.adjust)
plot3 <- ggdotchart(res_gse, x = "Description", y = "log_padjust",
color = "gene_clusters",
palette = c("#00AFBB", "#FC4E07"),
sorting = "descending",
rotate = TRUE,
group = "gene_clusters",
dot.size = 6,
add = "segments",
title = "Late RPCs + Muller cells vs Early RPCs",
xlab = "Pathways",
ylab = "-log10(padjust)",
ggtheme = theme_pubr()
)
plot3
load("~/Documents/PhD_AI/sc_devil/data/metadata.Rdata")
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_1", "Donor_2", "Donor_3", "Donor_4", "Donor_5", "Donor_6", "Donor_7", "Donor_8",
"Donor_9", "Donor_10", "Donor_11", "Donor_12"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_test_retina_tissue3.Rdata")
View(stat_test_retina)
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_dev_stage_rpc.Rdata")
View(stat_test_retina)
load("~/Documents/PhD_AI/sc_devil/results/fit_results/stat_test_retina_cell_types1.Rdata")
View(stat_test_retina)
View(stat_test_retina)
