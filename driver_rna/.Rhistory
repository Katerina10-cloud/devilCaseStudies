load("D:/PhD_AI/sc_devil/data/metadata.Rdata")
load("D:/PhD_AI/sc_devil/data/metadata.Rdata")
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
library(tidyverse)
library(ggplot2)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_1"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
View(metadata)
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor 2"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_4"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_11"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_10"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_3"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_4"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_5"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_6"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_7"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal ganglion cell ", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal ganglion cell "),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_1"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_3"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_5"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_6"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_7"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal ganglion cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_1"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_3"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_4"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_5"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_6"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_7"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell", "GABAergic amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_9"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell", "GABAergic amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_10"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell", "GABAergic amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_11"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell", "GABAergic amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_12"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell", "GABAergic amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal rod cell", "glycinergic amacrine cell", "amacrine cell", "GABAergic amacrine cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
metadata <- metadata_filtered %>% select("cell_type") %>%
mutate(cell_clusters = case_when(
cell_type == "retinal rod cell"  ~ '0',
cell_type == "glycinergic amacrine cell"  ~ '1',
cell_type == "amacrine cell"  ~ '1'),
cell_type == "GABAergic amacrine cell"  ~ '1') %>%
select("cell_clusters")
metadata <- metadata_filtered %>% select("cell_type") %>%
mutate(cell_clusters = case_when(
cell_type == "retinal rod cell"  ~ '0',
cell_type == "glycinergic amacrine cell"  ~ '1',
cell_type == "amacrine cell"  ~ '1',
cell_type == "GABAergic amacrine cell"  ~ '1')) %>%
select("cell_clusters")
View(metadata)
View(metadata_filtered)
library(ggplot2)
load("D:/PhD_AI/sc_devil/results/fit_results/stat_test_res3.Rdata")
stat_test_res$diffexpressed <- "NO"
stat_test_res$diffexpressed[stat_test_res$lfc >= 1 & stat_test_res$adj_pval < 0.05] <- "UP"
stat_test_res$diffexpressed[stat_test_res$lfc <= -1 & stat_test_res$adj_pval < 0.05] <- "DOWN"
p1 <- ggplot(data = stat_test_res, aes(x = lfc, y = -log10(adj_pval), col = diffexpressed)) +
geom_vline(xintercept = c(-1, 1), col = "darkgreen", linetype = 'dashed') +
geom_hline(yintercept = -log10(0.05), col = "darkgreen", linetype = 'dashed') +
geom_point(size = 1) +
scale_color_manual(values = c("blue", "black", "red"))+
scale_x_continuous(breaks = seq(-8, 8, 1))+
labs(title="Devil:scRNA, single patients (15 500 cells)",x="effect size (log2)")+
theme_bw()+
theme(legend.position="none")+
font("xy.text", size = 10, color = "black")+
font("xlab", size = 10)+
font("ylab", size = 10)+
theme(plot.title=element_text(hjust=0.5, vjust=0.5))
library(gridExtra)
p1 <- ggplot(data = stat_test_res, aes(x = lfc, y = -log10(adj_pval), col = diffexpressed)) +
geom_vline(xintercept = c(-1, 1), col = "darkgreen", linetype = 'dashed') +
geom_hline(yintercept = -log10(0.05), col = "darkgreen", linetype = 'dashed') +
geom_point(size = 1) +
scale_color_manual(values = c("blue", "black", "red"))+
scale_x_continuous(breaks = seq(-8, 8, 1))+
labs(title="Devil:scRNA, single patients (15 500 cells)",x="effect size (log2)")+
theme_bw()+
theme(legend.position="none")+
font("xy.text", size = 10, color = "black")+
font("xlab", size = 10)+
font("ylab", size = 10)+
theme(plot.title=element_text(hjust=0.5, vjust=0.5))
library(ggplot2)
library(gridExtra)
p1 <- ggplot(data = stat_test_res, aes(x = lfc, y = -log10(adj_pval), col = diffexpressed)) +
geom_vline(xintercept = c(-1, 1), col = "darkgreen", linetype = 'dashed') +
geom_hline(yintercept = -log10(0.05), col = "darkgreen", linetype = 'dashed') +
geom_point(size = 1) +
scale_color_manual(values = c("blue", "black", "red"))+
scale_x_continuous(breaks = seq(-8, 8, 1))+
labs(title="Devil:scRNA, single patients (15 500 cells)",x="effect size (log2)")+
theme_bw()+
theme(legend.position="none")+
font("xy.text", size = 10, color = "black")+
font("xlab", size = 10)+
font("ylab", size = 10)+
theme(plot.title=element_text(hjust=0.5, vjust=0.5))
library(ggpubr)
p1 <- ggplot(data = stat_test_res, aes(x = lfc, y = -log10(adj_pval), col = diffexpressed)) +
geom_vline(xintercept = c(-1, 1), col = "darkgreen", linetype = 'dashed') +
geom_hline(yintercept = -log10(0.05), col = "darkgreen", linetype = 'dashed') +
geom_point(size = 1) +
scale_color_manual(values = c("blue", "black", "red"))+
scale_x_continuous(breaks = seq(-8, 8, 1))+
labs(title="Devil:scRNA, single patients (15 500 cells)",x="effect size (log2)")+
theme_bw()+
theme(legend.position="none")+
font("xy.text", size = 10, color = "black")+
font("xlab", size = 10)+
font("ylab", size = 10)+
theme(plot.title=element_text(hjust=0.5, vjust=0.5))
p1
View(stat_test_res)
p1 <- ggplot(data = stat_test_res, aes(x = lfc, y = -log10(adj_pval), col = diffexpressed)) +
geom_vline(xintercept = c(-1, 1), col = "darkgreen", linetype = 'dashed') +
geom_hline(yintercept = -log10(0.05), col = "darkgreen", linetype = 'dashed') +
geom_point(size = 1) +
scale_color_manual(values = c("blue", "black", "red"))+
scale_x_continuous(breaks = seq(-8, 8, 2))+
labs(title="Devil:scRNA, single patients (15 500 cells)",x="effect size (log2)")+
theme_bw()+
theme(legend.position="none")+
font("xy.text", size = 10, color = "black")+
font("xlab", size = 10)+
font("ylab", size = 10)+
theme(plot.title=element_text(hjust=0.5, vjust=0.5))
p1
load("D:/PhD_AI/sc_devil/data/metadata.Rdata")
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_1"),
cell_type %in% c("retinal progenitor cell", "retinal rode cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal progenitor cell", "retinal rode cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_3"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_4"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_5"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_5"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_1"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_2"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_3"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_4"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_5"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_6"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_7"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_7"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_9"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_10"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_11"),
cell_type %in% c("retinal cone cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_11"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_10"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_9"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
#Data filtering for donor ID and cell type
metadata_filtered <- metadata %>%
filter(donor_id %in% c("Donor_8"),
cell_type %in% c("retinal progenitor cell", "retinal rod cell"),
sequencing_platform %in% c("Illumina NovaSeq 6000"))
View(metadata_filtered)
